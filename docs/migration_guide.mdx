---
title: "Migration Guide: v0.x to v1.x"
description: "Guide for migrating from Agency Swarm v0.x to v1.x (OpenAI Agents SDK based)"
icon: "book"
---

Agency Swarm v1.x introduces significant changes to the API, including some breaking changes.

This page provides a guide highlighting the most important changes to help you migrate your code from Agency Swarm v0.x to v1.x.

<Warning>
v1.x is currently in beta. We recommend using v0.x for production applications until v1.0 reaches general availability.
</Warning>

## What’s New in v1.x

**Complete Rewrite on OpenAI Agents SDK**  
Agency Swarm v1.x is completely rewritten on OpenAI’s new Agents SDK. No more black-box Assistants API - we now have direct control over threads and runs, with responsibility transferred to the framework level.

**Responses API Integration**  
Now uses OpenAI’s Responses API by default, which allows sending full conversation histories without assistants, threads and runs (unlike Assistants API). This simpler approach gives Agency Swarm complete control over conversation history management and run execution.

**Enhanced Model Support**

- **New Models**: Native support for o3, o4-mini through Responses API
- **Web Search & Computer Use**: Built-in support for Search and Computer Use models/agents
- **Third-Party Providers**: Support for any model provider adhering to Chat Completions API standard

**Architectural Improvements**

- **Async-first**: Main methods now require `await` for better performance
- **Better Control**: More granular execution control via `agents.Runner`
- **Flexible Persistence**: Custom conversation history management
- **Structured Outputs**: Native Pydantic model support for agent outputs

## Breaking Changes & Compatibility

### Critical Breaking Changes

<Warning>
**These changes will cause your v0.x code to crash in v1.x and require immediate attention:**

1. **`response_format` parameter**: Now throws `NotImplementedError` - must migrate to Agent-level `output_type`
1. **`response_validator` parameter**: Completely removed from Agent class - must migrate to `output_guardrails`
1. **Thread callbacks data format**: Now stores complete conversation histories instead of thread IDs
1. **Async-only methods**: `get_response()` and `get_response_stream()` are async and required `await`

</Warning>

### Backward Compatibility

Agency Swarm v1.x maintains backward compatibility where possible:

- **`agency_chart`**: Still works but deprecated. Migrate to positional arguments + `communication_flows`
- **`get_completion()`**: Maintained as synchronous wrapper, but deprecated
- **`get_completion_stream()`**: **Not supported** - raises `NotImplementedError`. Use async `get_response_stream()`
- **Agent Parameters**: Individual model parameters still work but deprecated. Use `model_settings` instead
- **`BaseTool`**: Temporarily retained for gradual migration to `@function_tool` decorator

## Step-by-Step Migration

<Steps>
<Step title="Install v1.x Beta">
```bash
# For beta testing
pip install "agency-swarm>=1.0.0-beta.1"

# For production (recommended)

pip install "agency-swarm<1.0.0"

```
</Step>

<Step title="Fix Immediate Crashes">
**Replace `response_format` parameter:**
```python
# REMOVE this (will crash):
agency.get_completion(response_format={"type": "json_schema", ...})

# REPLACE with Agent-level output_type:
from pydantic import BaseModel

class TaskOutput(BaseModel):
    status: str
    result: str

agent = Agent(output_type=TaskOutput, ...)
```

**Replace `response_validator` parameter:**

```python
# REMOVE this (will be ignored):
agent = Agent(response_validator=my_validator, ...)

# REPLACE with guardrails:
from agents import output_guardrail, GuardrailFunctionOutput

@output_guardrail
async def my_guardrail(ctx, agent, response) -> GuardrailFunctionOutput:
    # Your validation logic
    return GuardrailFunctionOutput(...)

agent = Agent(output_guardrails=[my_guardrail], ...)
```

</Step>

<Step title="Update Agency Constructor">
**New Pattern (Recommended)**:
```python
agency = Agency(
    entry_point_agent,  # Positional argument
    communication_flows=[(agent1, agent2)],
    load_threads_callback=lambda: load_threads(chat_id),
    save_threads_callback=lambda new_threads: save_threads(new_threads)
)
```

**Deprecated Pattern (Still Works)**:

```python
agency = Agency(
    agency_chart=[agent1, [agent1, agent2]],  # Will show warning
    threads_callbacks={'load': load_callback, 'save': save_callback}
)
```

</Step>

<Step title="Update Thread Callbacks (Production Required)">
Your callback implementations stay the same, but data format changes:

```python
def load_threads(chat_id):
    # v0.x: Load thread IDs only
    # v1.x: Load complete conversation histories
    return load_conversation_history(chat_id)

def save_threads(new_threads):
    # v0.x: Save thread IDs only  
    # v1.x: Save complete conversation histories
    save_conversation_history(new_threads)

# v0.x
agency = Agency(
    agents,
    threads_callbacks={
        'load': lambda: load_threads(chat_id),
        'save': lambda new_threads: save_threads(new_threads)
    }
)

# v1.x
agency = Agency(
    entry_agent,
    load_threads_callback=lambda: load_threads(chat_id),
    save_threads_callback=lambda new_threads: save_threads(new_threads)
)
```

</Step>

<Step title="Update Agent Definitions">
**Model Settings**:
```python
# v0.x
agent = Agent(temperature=0.7, max_completion_tokens=1000)

# v1.x (recommended)

from agents import ModelSettings

agent = Agent(
model_settings=ModelSettings(
model="gpt-4o",
temperature=0.7,
max_completion_tokens=1000
)
)

```
</Step>

<Step title="Convert Tools">
**v0.x Tool**:
```python
class MyTool(BaseTool):
    arg1: str = Field(..., description="Description")

    def run(self):
        return f"Result: {self.arg1}"
```

**v1.x Tool**:

```python
from agents import function_tool

@function_tool
def my_tool(arg1: str) -> str:
    """Tool description."""
    return f"Result: {arg1}"
```

</Step>

<Step title="Update Method Calls (Optional)">
**v0.x (still works with deprecation warning)**:
```python
result = agency.get_completion("Hello", recipient_agent="Agent1")
```

**v1.x Recommended** (async):

```python
import asyncio

async def main():
    result = await agency.get_response(
        message="Hello",
        recipient_agent="Agent1"
    )
    print(result.final_output)

asyncio.run(main())
```

</Step>
</Steps>

## Complete Code Examples

<Tabs>
<Tab title="v0.x (Current Production)">
```python
from agency_swarm import Agency, Agent, BaseTool
from pydantic import Field

# Tool Definition

class MyTool(BaseTool):
"""Custom tool for v0.x."""
field1: str = Field(..., description="Input field")

```
def run(self):
    return f"Processed: {self.field1}"
```

# Agent Definition

agent1 = Agent(
name="Agent1",
description="First agent",
instructions="You are a helpful assistant.",
tools=[MyTool],
temperature=0.7,
max_completion_tokens=1000
)

agent2 = Agent(
name="Agent2",
description="Second agent",
instructions="You process results.",
temperature=0.3
)

# Agency Setup

agency = Agency(
agency_chart=[
agent1,  # Entry point
[agent1, agent2]  # Communication flow
],
shared_instructions="Be helpful and accurate."
)

# Usage

result = agency.get_completion(
message="Start processing",
recipient_agent="Agent1"
)
print(result)

```
</Tab>

<Tab title="v1.x (Beta Preview)">
```python
from agency_swarm import Agency, Agent
from agents import function_tool, ModelSettings
from pydantic import BaseModel, Field
import asyncio

# Structured Output Model
class TaskResult(BaseModel):
    status: str = Field(..., description="Task status")
    result: str = Field(..., description="Task result")

# Tool Definition
@function_tool
def my_tool(field1: str) -> str:
    """Custom tool for v1.x."""
    return f"Processed: {field1}"

# Agent Definition
agent1 = Agent(
    name="Agent1",
    description="First agent",
    instructions="You are a helpful assistant.",
    tools=[my_tool],
    output_type=TaskResult,
    model_settings=ModelSettings(temperature=0.7, max_completion_tokens=1000)
)

agent2 = Agent(
    name="Agent2",
    description="Second agent",
    instructions="You process results.",
    model_settings=ModelSettings(temperature=0.3)
)

# Agency Setup
agency = Agency(
    agent1,  # Entry point (positional)
    communication_flows=[(agent1, agent2)],
    shared_instructions="Be helpful and accurate."
)

# Usage (Backward Compatible)
result = agency.get_completion(
    message="Start processing",
    recipient_agent="Agent1"
)
print(result)

# Usage (v1.x Recommended - async)
async def main():
    result = await agency.get_response(
        message="Start processing",
        recipient_agent="Agent1"
    )
    print(result.final_output)

asyncio.run(main())
```

</Tab>
</Tabs>

## Resources

### Available Examples

The [`/examples`](https://github.com/VRSEN/agency-swarm/tree/release/v1.0.0-beta/examples) directory contains comprehensive examples demonstrating v1.x features and migration patterns:

- **`two_agent_conversation.py`** - Multi-agent communication with thread isolation and tool delegation
- **`streaming.py`** - Real-time response streaming with async handling
- **`file_handling.py`** - File processing and vision using OpenAI’s built-in capabilities
- **`file_search.py`** - Vector store creation and FileSearch with automatic indexing
- **`multi_agent_workflow.py`** - Complex multi-agent collaboration with validation
- **`response_validation.py`** - Input/output guardrails with tripwire triggers
- **`custom_persistence.py`** - Thread isolation and persistence across restarts
- **`chat_completion_provider.py`** - Custom model providers and multi-agent management

### Additional Resources

- [OpenAI Agents SDK Documentation](https://openai.github.io/openai-agents-python/)
- [Agency Swarm v0.x Documentation](https://agency-swarm.ai) (current production docs)
- [GitHub Issues](https://github.com/VRSEN/agency-swarm/issues) - Report v1.x beta issues with the **v1.x beta** label
